[操作系统引论](../操作系统原理.md)
# OS结构设计

<!-- TOC -->

- [OS结构设计](#os结构设计)
  - [传统OS结构](#传统os结构)
    - [无结构OS](#无结构os)
    - [模块化OS](#模块化os)
    - [分层式OS](#分层式os)
  - [客户/服务器模式（Client/Server模式）](#客户服务器模式clientserver模式)
    - [组成](#组成)
    - [交互](#交互)
    - [优缺点](#优缺点)
  - [O-OP程序设计](#o-op程序设计)
  - [微内核OS](#微内核os)
    - [微内核](#微内核)
    - [机制-策略分离原理](#机制-策略分离原理)
    - [核心功能](#核心功能)
    - [优缺点](#优缺点-1)

<!-- /TOC -->
---
## 传统OS结构
### 无结构OS

### 模块化OS
* 模块化程序设计
    ```mermaid
        graph LR;
              操作系统-->进程管理;
              操作系统-->存储器管理;
              操作系统-->文件管理;
              进程管理-->进程控制;
              进程管理-->进程调度;
              存储器管理-->内存分配
              存储器管理-->内存保护
              文件管理-->磁盘管理
              文件管理-->目录管理
    ```
* 模块独立性
   1. 内聚性：模块内部各部分联系的紧密程度
   2. 耦合度：模块间相互联系、影响的程度
* 优缺点
  * 优点
    * 提高OS设计的正确性、可理解性、可维护性
    * 增强OS的适应性
    * 加速OS的开发过程
  * 缺点：
    * 在OS设计时，对各个模块间的接口规定很难满足在模块完成后对接口的实际需求
    * 在模块化结构设计中，各个模块的设计齐头并进，无法找到一个可靠的决定顺序，导致各种决定的无序性
  
### 分层式OS
**自底向上**的分层设计：每一步设计都建立在可靠的基础层上  
**高层**只能调用**低层**的功能
* 优点
  * 易于保证系统的正确性
  * 易扩充性和易维护性
* 缺点
  * 系统效率降低，需要在每个相邻层之间建立通信机制，且执行功能需要自上而下穿越多个层次
  
---
## 客户/服务器模式（Client/Server模式）
### 组成
* 提供各种服务的一组服务器（进程），运行在用户态
* 内核态用于处理客户端和服务端之间的通信
* 客户机--网络系统--服务器

### 交互
略

### 优缺点
优点：
* 灵活性
* 提高OS可靠性
* 运行于分布式系统
  * 数据的分布式处理和存储
  * 便于集中管理
  * 灵活性和可扩充性
  * 易于改编应用软件

缺点：
* 不可靠性
* 性能瓶颈问题

---
## O-OP程序设计
进程对象、线程对象、存储器对象等

---
## 微内核OS
### 微内核
实现OS核心功能的小型内核，运行在核心态，开机后**常驻内存**

### 机制-策略分离原理
**机制**：实现某一功能的具体执行机构  
**策略**：在机制等基础上，借助于某些参数和算法实现功能的优化，或达成不同的功能目标  
通常机制处于系统的基层，而策略处于系统的高层，在微内核OS中将机制放在OS的微内核中

### 核心功能
* 进程/线程管理
  * 调度功能
  * 通信功能
* 低级存储管理
  * 页表机制
  * 地址变换机制
* 中断/陷入处理
  * 捕获发生的中断、陷入，进行前期处理
  * 陷入（Trap）：内中断（如exception异常）

### 优缺点
优点：
* 可扩展性
* 可靠性
* 可移植性
* 分布式系统支持
* O-OP思想

缺点：
* 效率降低：频繁的上下文切换