[存储器管理](../操作系统原理.md)
# 对换
<!-- TOC -->

- [对换](#对换)
  - [多道程序环境的对换](#多道程序环境的对换)
    - [对换类型](#对换类型)
  - [对换空间的管理](#对换空间的管理)
    - [主要目标](#主要目标)
    - [数据结构](#数据结构)
    - [分配回收](#分配回收)
  - [换出换入](#换出换入)
    - [程序的换出](#程序的换出)
    - [程序的换入](#程序的换入)

<!-- /TOC -->
---
## 多道程序环境的对换
**对换**：将内存和外存的程序/数据段进行交换

### 对换类型
* 整体对换
* 页面（分段）对换

---
## 对换空间的管理
### 主要目标
在支持对换的OS中，把磁盘空间分为文件区和对换区
* 对于文件区，要采用离散分配方式，提高存储空间利用率
* 对于对换区，要采用连续分配方式，提高进程换进换出速度

### 数据结构
接近空闲分区表/空闲分区链
* 对换区始址——盘块号
* 对换区大小——盘块数

### 分配回收
与动态分区算法雷同，如FF、NF、BF等

---
## 换出换入
### 程序的换出
将内存中的进程调出至对换区，腾出内存空间
换出过程：
1. 选择换出进程（考虑进程状态、优先级、驻留时间）
2. 进程换出过程（申请对换空间、启动磁盘、传送程序和数据）

### 程序的换入
对换进程定时执行换入操作。
* 查看PCB集合中所有进程的状态
* 找出"就绪"状态但已换出的进程。
  * 当有许多这样的进程时，找出已换出到磁盘上最久的进程
  * 换出最久的进程仍需满足最小换出时间的限制（如2s）
* 如果申请成功，则可将进程从外村掉入内存
* 如果申请失败，则先将内存中的某些进程换出
