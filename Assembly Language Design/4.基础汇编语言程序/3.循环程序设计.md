
# 循环程序设计

---
## 循环控制指令
指令格式：OPCODE DISP  
DISP为八位补码，表示本指令下一条始址与目标单元的距离  
指定一定条件，当条件满足时IP+=DISP，即IP+=DISP使程序转移到目的指令  
指令通过CX寄存器做循环计数，对标志位无影响

### LOOP指令
* 格式：LOOP 目标
    * 目标：程序中的一个标号
    * 每执行一次LOOP使CX--
    * 当CX不等于0时跳转到目标处
    * 当CX等于0时顺序执行

### LOOPE/LOOPZ指令
* 格式：LOOPE/LOOPZ 目标 
    * 同上，但仅当CF不为0且ZF=1时跳转到目标

### LOOPNE/LOOPNZ指令
* 格式：LOOPNE/LOOPNZ 目标 
    * 同上，但仅当CF不为0且ZF=0时跳转到目标

### JCXZ指令
* 格式：JCXZ 目标 
    * 同上，但仅当CF为0时跳转到目标
    * 常用于循环之前，若循环次数为0则不执行循环（跳转到循环体下方）
    * 没有这个的话会强制执行循环，CX=CX-1=0-1=0FFFFH，产生错误

---
## 结构形式
```mermaid
    graph TB;
            A[[循环初始化]]-->B[[循环体]];
            B-->C<控制条件>;
            C-->|Yes|B;
            C-->|No|D[[处理结束部分]]
```


```mermaid
    graph TB;
            A[[循环初始化]]-->C<控制条件>;
            B[[循环体]]-->C;
            C-->|Yes|B;
            C-->|No|D[[处理结束部分]]
```

* 初始化
    * 用于创建初始状态，如循环次数计数器、地址指针和其他循环参数
* 循环体
    * 工作：完成循环体主要任务
    * 修改：修改条件参数以跳出循环
* 循环控制
    * 用计数器控制循环——已知循环次数
    * 用条件判断循环——未知循环次数
* 结束处理
    * 处理循环结束后的结果，如存储结果

---
## 单重循环程序
### 计数控制循环
用CX作为循环次数计数器，LOOP/LOOPE/LOOPNE作为循环控制指令

## 多重循环程序
循环程序的循环体中又包含了另一个循环