
# 中断传送

---
## 中断与中断源
**中断**：当一种特殊事件发生时，CPU停止正在运行的程序，转去执行该事件的处理程序
**中断源**：引起中断的事件，在电路中一般以触发器表示，高电平有效
![]()

---
## 中断分类
* 外部中断
    * 非屏蔽中断NMI
        * CPU不能禁止NMI上的中断请求，用于处理紧急故障
    * 可屏蔽中断INTR
        * CPu是否做出响应由该中断是否被屏蔽以及CPU是否允许响应决定
* 内部中断
    * INT中断
        * 执行INT指令产生的中断
    * 处理CPU错误
        * 除法错中断和溢出中断
    * 调试程序中断
        * 单步中断、断点中断、失效、陷阱和中止

### 外部中断
又称**硬中断**，来自处理机的外部条件，如IO或其他处理机
* NMI中断直接连接CPU，无法屏蔽，用于处理紧急故障，如电源掉电等
* INTR中断用于外部设备的中断请求，通过8259A可编程控制器与CPU相连
    * 是否响应由两个控制条件共同决定：
        * 外设的中断请求是否被屏蔽：由8259A中的中断屏蔽寄存器（IMR）控制
        * CPU是否允许响应中断：由标志寄存器（PSW）中的中断允许位IF控制
    * 在外部中断请求未被屏蔽下，CPU是否响应与IF位有关
        * IF=0则CPU禁止响应任何外设的中断
        * IF=1则响应中断
        * 可用STI和CLI来控制IF位

中断屏蔽寄存器格式：
|7|6|5|4|3|2|1|0|
|----|----|----|----|----|----|----|----|
|打印机|软盘|硬盘|串行口|串行口1|保留|键盘|定时器|

### 内部中断
又称**软件中断**，通常由三种情况引起
* INT中断
    * 执行INT指令时立即产生中断，并调用系统中相应的中断处理程序完成中断功能
* CPU错误中断
    * 除法错中断：除数为0或者商超过了寄存器范围，产生类型为0的中断
    * 溢出中断：溢出标志位OF为1，则执行INTO指令来中断发生溢出的算术操作
* 调试程序（DEBUG）设置的中断
    * 单步中断
    * 断点中断
* 上述中断中除调试中断外均为非屏蔽中断

### 异常中断
80386处理机将执行过程中产生的错误情况也纳入中断范围，称为**异常中断**/**异常**
* 失效（Faults）
    * 
* 陷阱（Traps）
* 终止（Abort）